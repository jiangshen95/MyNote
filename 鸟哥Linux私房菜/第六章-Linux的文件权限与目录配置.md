# 使用者与群组
1. 文件拥有者(User)
2. 群组概念(Group)  
  每个账号都可以由多个群组的支持
3. 其他人的概念(Others)
* Linux用户身份与群组的记录文件  
  默认情况下，所有的系统上的账号与一般身份使用者，还有那个root的相关信息，都是记录在/etc/passwd这个文件内。个人的密码则是记录在/etc/shadow这个文件下。此外，Linux所有的组名都记录在/etc/group内。

# Linux的文件权限概念
## Linux文件属性
ls是『list』的意思，重点在显示文件的文件名与相关属性。而选项『-al』则表示列出所有的文件详细的权限与属性 (包含隐藏档，就是文件名第一个字符为『 . 』的文件)。
```
drwxr-xr-x  5 root root     4096 5月  29  2018 tensorflow
drwxrwx---  3 miao miao     4096 2月  16 16:53 .theano
drwxrwxr-x  6 miao miao     4096 2月  21 16:38 .vim
-rw-------  1 miao miao    19252 2月  26 10:19 .viminfo
-rw-rw-r--  1 miao miao     6973 4月  18  2018 .vimrc
drwx------  2 miao miao     4096 11月 30  2017 .vnc
-rw-r--r--  1 root root      175 5月  29  2018 .wget-hsts
```
* 第一栏代表这个文件的类型与权限(permission)  
  这一栏共有十个字符
    * 第一个字符代表这个文件是[目录、文件或链接文件等等]
        * 当为[d]则是目录
        * 当为[-]则是文件
        * 若是[l]则表示连结档(link file)
        * 若是[b]则表示为装置文件里面的可供存储的接口设备(可随机存取装置)
        * 若是[c]则表示为装置文件里面的串行端口设备，例如键盘，鼠标(一次性读取装置)。
    * 接下来的字符，以三个为一组，且均为[rwx]的三个参数的组合。其中，[r]代表可读(read)、[w]代表可写(write)、[x]代表可执行(execute)。这三个权限的位置不会变，如果没有权限，就会出现减号[-]
        * 第一组为[文件拥者的权限]
        * 第二组为[同群组的权限]
        * 第三组为[非其他本群组的权限]
    > 目录与文件的权限意义并不相同

* 第二栏表示有多少档名连结到此节点(i-node)：  
* 第三栏表示这个文件（或目录）的[拥有着账号]
* 第四栏表示这个文件的所属群
* 第五栏为这个文件的容量大小，单位为bytes
* 第六栏位这个文件的建档日期或者最近修改的日期  
  日期（月/日）及时间，如果这个文件被修改的时间距离现在太久，那么时间部分会仅显示年份。  
  如果想要显示完整的时间格式，可以利用ls的选项，[`ls -l --full-time`]，就能显示出完整的时间格式了
* 第七栏位这个文件的档名  
  如果档名之前多了一个[.]，则代表这个文件位[隐藏档]
* Linux文件权限的重要性
    * 系统保护的功能
    * 团队开发软件或数据共享的功能
    
## 如何变更文件属性与权限
* 改变所属群组，`chgrp`  
  被改变的组名必须要在/etc/group文件内存在才行  
  `chgrp [-R] dirname/filename`
* 改变文件拥有者，`chown`  
  用户必须已经存在系统中的账号，/etc/passwd这个文件中记录  
  ```
  chown [-R] 账户名称 文件或目录
  chown [-R] 账户名称:组名 文件或目录 或者 chown [-R] 账户名称.组名 文件或目录
  -R：进行递归(recursive)的持续变更，亦即连同目录下所有文件都变更
  只修改组名： chown [-R] .组名 文件或目录
  ```
* 改变权限，`chmod`
    * 数字类型改变文件权限  
      owner/group/others  read/write/execute  
      使用数字代表各个权限：r-4， w-2, x-1  
      每种身份各自的三个权限分数是需要累加的。例如
      ```
      [-rwxrwx---]
      owner = rwx = 4 + 2 + 1 = 7
      write = rwx = 4 + 2 + 1 = 7
      others = --- = 0 + 0 + 0 = 0
      ```
      `chmod [-R] xyz 文件或目录`  
      以vim编辑的一个shell的文字批处理文件后，他的权限通常是-rw-rw-r--也就是644，如果要将该文件变成可执行文件，并且不要让其他人修改，就需要-rwxr-xr-x，也就需要下达[`chmod 755 test.sh`]指令
    * 符号类型改变文件权限  
      藉由u, g, o代表三种身份（owner/group/others）的权限 a代表all亦即全部的身份，读写权限写成r,w,x
      ||||||
      :---:|:---:|:---:|:---:|:---:
      chmod|u<br>g<br>o<br>a|+(加入)<br>-(除去)<br>=(设定)|r<br>w<br>x|文件或目录
      ||

## 目录与文件之权限意义
### 权限对文件的重要性
文件是实际含有数据的地方，包括一般文本文件、数据库内容文件、二进制可执行文件(binary program)等等。权限对文件的意义：
* r (read)：可读取此一文件的实际内容，如读取文本文件的文字内容等；
* w (write)：可以编辑、新增或者是修改该文件的内容(但不含删除该文件)；
* x (execute)：该文件具有可以被系统执行的权限。

> Linux底下，文件是否能被执行，藉由是否具有[x]这个权限来决定，跟档名没有绝对的关系  
对于文件的rwx来说，主要都是针对[文件内容]而言，与文件档名的存在与否没有直接关系

### 权限对目录的重要性
目录主要的内容在记录文件名列表
* r (read contents in directory)：表示具有读取目录结构列表的权限，所以当你具有读取(r)一个目录的权限时，表示你可以查询该目录下的文件名数据。 所以你就可以利用 ls 这个指令将该目录的内容列表显示出来！
* w (modify contents of directory)：这个可写入的权限对目录来说，表示具有改动该目录结构列表的权限，也就是底下这些权限：
    * 建立新的文件与目录；
    * 删除已经存在的文件与目录(不论该文件的权限为何！)
    * 将已存在的文件或目录进行更名；
    * 搬移该目录内的文件、目录位置。
* x(access directory)：表示用户能否进入该目录成为工作目录的用途，所谓工作目录(work directory)就是目前所在的目录。
  开放目录给别人浏览，应该至少要给予r及x的权限。

## Linux文件种类与扩展名
* 文件种类
    * 正规文件(regular file)：  
      一般进行存取的文件[-]，大致分为：
        * 纯文本文档(ASCII)
        * 二进制文件(binary)：可执行文件(scripts，文字型批处理文件不算)
        * 数据格式文件(data)：有些程序在运作的过程中会读取某些特定格式的文件。
    * 目录(directory) [d]
    * 连结档(link)：[l]类似快捷方式
    * 设备与装置文件(device)：  
      与系统周边及存储等相关的一些文件，通常集中在/dev这个目录下，通常分为两种：
        * 区块(block)设备档：就是一些储存数据，以提供系统随机存取的接口设备 [b]
        * 字符(character)设备文件：亦即一些串行端口的接口设备，例如键盘，鼠标等。一次性读取，不能够截断输出。[c]
    * 数据接口文件(sockets)：  
      用于网络上的数据承接，可以启动一个程序来监听客户端的要求，而客户端就可以透过这个socket来进行数据的沟通了。第一个属性位[s]，最常在/var/run这个目录中
    * 数据输送文件(FIFO, pipe)：
      FIFO也是一种特殊的文件类型，主要目的在解决多个程序同时存取一个文件所造成的错误问题。first-in-first-ou第一个属性为[p]
* Linux文件扩展名  
  一个Linux文件能不能被执行，与他的第一栏的十个属性有关， 与档名根本一点关系也没有。不过如果文件不是可执行文件，不能成功执行。常用扩展名：
    * *.sh：脚本或批处理(scripts)，因为批处理文件为使用shell写成的，所以扩展名就编成.sh
    * *Z, *.tar, *.zip, *.tgz：经过打包的压缩文件。因为压缩软件分别为gunzip，tar等。
    * *.html, *.php：网页相关文件
* Linux文件名长度限制  
  使用预设的Ext2/Ext3文件系统时，针对文件的档名长度限制为：
    * 单一文件或目录的最大容许文件名为255个字符；
    * 包含完整路径名称及目录(/)之完整档名为4096个字符
* Linux文件名的限制  
  避免一些特殊字符，以小数点[.]开头时为隐藏文件

# Linux目录配置
## Linux目录配置的依据——FHS
||可分享的(shareable)|不可分享的(unshareable)
:---:|:---:|:---:
不变的(sattic)|/usr(软件放置处)|/etc(配置文件)
||/opt(第三方协议软件)|/boot(开机与核心档)
可变动的(variable)|/var/mail(使用者邮件信箱)|/var/run(程序相关)
||/var/spool/news(新闻组)|/var/lock(程序相关)
* 可分享的：可以分享给其他系统挂载使用的目录，所以包括执行文件与用户的邮件等数据，能够分享给网络上其他主机挂载用的目录
* 不可分享的：自己机器上面运作的装置文件或者是与程序有关的socket文件等
* 不可变的：有些数据不会经常变动，跟随着distribution而不变动。例如函数库、文本说明文件、系统管理员所管理的主机服务配置文件等等。
* 可变动的：经常改变的数据，例如登陆文件，一般用户可自行收受的新闻组等

事实上，FHS针对目录树架构仅定义出三层目录底下应该放置什么数据：
* /(root，根目录)：与开机系统有关
* /usr(unix software resource)：与软件安装/执行有关
* /var(vriable)：与系统运作过程有关

### 根目录（/）的意义与内容
根目录是整个系统最重要的一个目录，因为不但所有的目录都是由根目录衍生出来的， 同时根目录也与开机/还原/系统修复等动作有关。 由于系统开机时需要特定的开机软件、核心文件、开机所需程序、 函式库等等文件数据，若系统出现错误时，根目录也必须要包含有能够修复文件系统的程序才行。FHS希望根目录不要放在非常大的分割槽内， 因为越大的分割槽妳会放入越多的数据，如此一来根目录所在分割槽就可能会有较多发生错误的机会。  
FHS标准建议：根目录(/)所在分割槽应该越小越好， 且应用程序所安装的软件最好不要与根目录放在同一个分割槽内，保持根目录越小越好。 如此不但效能较佳，根目录所在的文件系统也较不容易发生问题。  
根目录(/)底下应该要有的目录

目录|应放置文件内容
:---:|:---
/bin|系统有很多放置执行文件的目录，但/bin比较特殊。因为/bin放置的是在单人维护模式下还能够被操作的指令。 在/bin底下的指令可以被root与一般账号所使用，主要有：cat, chmod, chown, date, mv, mkdir, cp, bash等等常用的指令。
/boot|这个目录主要在放置开机会使用到的文件，包括Linux核心文件以及开机选单与开机所需配置文件等等。 Linux kernel常用的档名为：vmlinuz，如果使用的是grub这个开机管理程序， 则还会存在/boot/grub/这个目录。
/dev|在Linux系统上，任何装置与接口设备都是以文件的型态存在于这个目录当中的。 你只要透过存取这个目录底下的某个文件，就等于存取某个装置，比要重要的文件有/dev/null, /dev/zero, /dev/tty, /dev/lp*, /dev/hd*, /dev/sd*等等
/etc|系统主要的配置文件几乎都放置在这个目录内，例如人员的账号密码文件、 各种服务的启始档等等。一般来说，这个目录下的各文件属性是可以让一般使用者查阅的， 但是只有root有权力修改。FHS建议不要放置可执行文件(binary)在这个目录中。比较重要的文件有： /etc/inittab, /etc/init.d/, /etc/modprobe.conf, /etc/X11/, /etc/fstab, /etc/sysconfig/ 等等。另外，其下重要的目录有： <br><br> * /etc/init.d/：所有服务的预设启动 script 都是放在这里的，例如要启动或者关闭 iptables 的话：『 /etc/init.d/iptables start』、『/etc/init.d/iptables stop』<br>* /etc/xinetd.d/：这就是所谓的super daemon管理的各项服务的配置文件目录。<br>* /etc/X11/：与 X Window 有关的各种配置文件都在这里，尤其是 xorg.conf 这个 X Server 的配置文件。
/home|这是系统默认的用户家目录(home directory)。在你新增一个一般使用者账号时， 默认的用户家目录都会规范到这里来。比较重要的是，家目录有两种代号：<br>~：代表目前这个用户的家目录，而 <br>~dmtsai ：则代表 dmtsai 的家目录！
/lib|系统的函式库非常的多，而/lib放置的则是在开机时会用到的函式库， 以及在/bin或/sbin底下的指令会呼叫的函式库而已。 什么是函式库呢？妳可以将他想成是『外挂』，某些指令必须要有这些『外挂』才能够顺利完成程序的执行之意。 尤其重要的是/lib/modules/这个目录， 因为该目录会放置核心相关的模块(驱动程序)！
/media|media是『媒体』的英文，顾名思义，这个/media底下放置的就是可移除的装置。 包括软盘、光盘、DVD等等装置都暂时挂载于此。常见的档名有：/media/floppy, /media/cdrom等等。
/mnt|如果妳想要暂时挂载某些额外的装置，一般建议妳可以放置到这个目录中。 在较早时候，这个目录的用途与/media相同啦！只是有了/media之后，这个目录就用来暂时挂载用了。
/opt|这个是给第三方协力软件放置的目录。 另外，如果想要自行安装额外的软件(非原本的distribution提供的)，那么也能够将你的软件安装到这里来。 不过，以前的Linux系统中，习惯放置在/usr/local目录下
/root|系统管理员(root)的家目录。之所以放在这里，是因为如果进入单人维护模式而仅挂载根目录时， 该目录就能够拥有root的家目录，所以我们会希望root的家目录与根目录放置在同一个分割槽中。
/sbin|Linux有非常多指令是用来设定系统环境的，这些指令只有root才能够利用来『设定』系统，其他用户最多只能用来『查询』而已。 放在/sbin底下的为开机过程中所需要的，里面包括了开机、修复、还原系统所需要的指令。 至于某些服务器软件程序，一般则放置到/usr/sbin/当中。至于本机自行安装的软件所产生的系统执行文件(system binary)， 则放置到/usr/local/sbin/当中了。常见的指令包括：fdisk, fsck, ifconfig, init, mkfs等等。
/srv|srv可以视为『service』的缩写，是一些网络服务启动之后，这些服务所需要取用的数据目录。 常见的服务例如WWW, FTP等等。举例来说，WWW服务器需要的网页数据就可以放置在/srv/www/里面。
/tmp|这是让一般使用者或者是正在执行的程序暂时放置文件的地方。 这个目录是任何人都能够存取的，所以你需要定期的清理一下。当然，重要数据不可放置在此目录。FHS甚至建议在开机时，应该要将/tmp下的数据都删除
FHS标准之外的重要目录：
目录|应放置文件内容
:---:|:---:
/lost+found|这个目录是使用标准的ext2/ext3文件系统格式才会产生的一个目录，目的在于当文件系统发生错误时， 将一些遗失的片段放置到这个目录下。这个目录通常会在分割槽的最顶层存在， 例如你加装一颗硬盘于/disk中，那在这个系统下就会自动产生一个这样的目录『/disk/lost+found』
/proc|这个目录本身是一个『虚拟文件系统(virtual filesystem)』。他放置的数据都是在内存当中， 例如系统核心、行程信息(process)、周边装置的状态及网络状态等等。因为这个目录下的数据都是在内存当中， 所以本身不占任何硬盘空间。比较重要的文件例如：/proc/cpuinfo, /proc/dma, /proc/interrupts, /proc/ioports, /proc/net/* 等等。
/sys|这个目录其实跟/proc非常类似，也是一个虚拟的文件系统，主要也是记录与核心相关的信息。 包括目前已加载的核心模块与核心侦测到的硬件装置信息等等。这个目录同样不占硬盘容量
因为根目录与开机有关，开机过程中仅有根目录会被挂载，其他分割槽则是在开机完成之后才会持续的进行挂载的行为。因此根目录下与开机过程有关的目录，不能够跟根目录放到不同的分割槽，如下：
* /etc：配置文件
* /bin：重要执行档
* /dev：所需要的装置文件
* /lib：执行档所需的函数库与核心所需的模块
* /sbin：重要的系统执行文件

### /usr的意义与内容
Unix Software Resource。安装时会占用较大硬盘容量
目录|应放置文件内容
:---:|:---:
/usr/X11R6/|为X Window System重要数据所放置的目录，之所以取名为X11R6是因为最后的X版本为第11版，且该版的第6次释出之意。
/usr/bin/|绝大部分的用户可使用指令都放在这里！请注意到他与/bin的不同之处。(是否与开机过程有关)
/usr/include/|c/c++等程序语言的档头(header)与包含档(include)放置处，当我们以tarball方式 (*.tar.gz 的方式安装软件)安装某些数据时，会使用到里头的许多包含档
/usr/lib/|包含各应用软件的函式库、目标文件(object file)，以及不被一般使用者惯用的执行档或脚本(script)。 某些软件会提供一些特殊的指令来进行服务器的设定，这些指令也不会经常被系统管理员操作， 那就会被摆放到这个目录下。要注意的是，如果你使用的是X86_64的Linux系统， 那可能会有/usr/lib64/目录产生
/usr/local/|系统管理员在本机自行安装自己下载的软件(非distribution默认提供者)，建议安装到此目录， 这样会比较便于管理。举例来说，你的distribution提供的软件较旧，你想安装较新的软件但又不想移除旧版， 此时你可以将新版软件安装于/usr/local/目录下，可与原先的旧版软件有分别。你可以自行到/usr/local去看看，该目录下也是具有bin, etc, include, lib...的次目录
/usr/sbin/|非系统正常运作所需要的系统指令。最常见的就是某些网络服务器软件的服务指令(daemon)
/usr/share/|放置共享文件的地方，在这个目录下放置的数据几乎是不分硬件架构均可读取的数据， 因为几乎都是文本文件。在此目录下常见的还有这些次目录：<br>* /usr/share/man：联机帮助文件<br>* /usr/share/doc：软件杂项的文件说明<br>* /usr/share/zoneinfo：与时区有关的时区文件
/usr/src/|一般原始码建议放置到这里，src有source的意思。至于核心原始码则建议放置到/usr/src/linux/目录下。
### /var的意义与内容
/var目录主要针对常态性变动的文件，包括缓存(cache)、登陆档(log file)以及某些软件运作所产生的文件，包括程序文件(lock file, run file)，或者MySQL数据库的文件等等。/var在系统运作后会渐渐占用硬盘容量。
目录|应放置文件内容
:---:|:---:
/var/cache/|应用程序本身运作过程中会产生的一些暂存档；
/var/lib/|程序本身执行的过程中，需要使用到的数据文件放置的目录。在此目录下各自的软件应该要有各自的目录。 举例来说，MySQL的数据库放置到/var/lib/mysql/而rpm的数据库则放到/var/lib/rpm
/var/lock/|某些装置或者是文件资源一次只能被一个应用程序所使用，如果同时有两个程序使用该装置时， 就可能产生一些错误的状况，因此就得要将该装置上锁(lock)，以确保该装置只会给单一软件所使用。 举例来说，当第一个人在刻录时该刻录机就会被上锁， 第二个人就得要该装置被解除锁定(就是前一个人用完了)才能够继续使用。
/var/log/|重要！这是登录文件放置的目录，里面比较重要的文件如/var/log/messages, /var/log/wtmp(记录登入者的信息)等。
/var/mail/|放置个人电子邮件信箱的目录，不过这个目录也被放置到/var/spool/mail/目录中。通常这两个目录是互为链接文件
/var/run/|某些程序或者是服务启动后，会将他们的PID放置在这个目录下。至于PID的意义我们会在后续章节提到的。
/var/spool/|这个目录通常放置一些队列数据，所谓的『队列』就是排队等待其他程序使用的数据。这些数据被使用后通常都会被删除。举例来说，系统收到新信件会放置到/var/spool/mail/中， 但使用者收下该信件后该封信原则上就会被删除。信件如果暂时寄不出去会被放到/var/spool/mqueue/中， 等到被送出后就被删除。如果是工作排程数据(crontab)，就会被放置到/var/spool/cron/目录

## 目录树
* 目录树的起始点为根目录（/, root）
* 每一个目录不止能使用本地端的partition的文件系统，也可以使用网络上的filesystem。可以利用Netword File System(NFS)服务器挂载某特定目录等。
* 每一个文件在此目录树的文件名(包含完整路径)都是无一物二的。

## 绝对路径与相对路径
* 绝对路径：由根目录(/)开始写起的文件名或目录名称
* 相对路径：相对于目前路径的文件名写法（开头不是/）
* [.]代表当前的目录，也可以使用[./]表示
* [..]代表上一层目录，也可以使用[../]表示
> 由于指令的执行需要变量的支持，若执行文件放置在本目录，并且本目录并非正规的执行文件目录(/bin, /usr/bin等为正规)，此时要执行指令就要严格指定执行档。[./]代表[本目录]，所以[./run.sh]，代表执行本目录下的run.sh文件